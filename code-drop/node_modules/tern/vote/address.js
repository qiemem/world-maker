var data = require("fs").readFileSync(process.argv[2], "utf8");

// Date,Amount,Visibility2,Perk3,Username,Email,Name6,Address7,City8,State9,Zipcode10,Country11

var countries = {};

require("csv")().from(data).on("record", function(row, i) {
  if (row[3] == "Authentic Tern laptop stickers") {
    var addr = row[6] + "\n" + row[7] + "\n" + (row[10] ? row[10] + " " : "") + row[8] + (row[9] ? ", " + row[9] : "") + (row[11] != "Germany" ? "\n" + row[11] : "");
    var list = countries[row[11]] || (countries[row[11]] = []);
    list.push(addr);
  }
}).on("end", function() {
  var sum = 1;
  for (var c in countries) {
    sum += countries[c].length;
/*    countries[c].forEach(function(a) {
      console.log(a + "\n");
    });*/
  }
  console.log(sum);
});
